var app=angular.module("Fusball",["ngRoute"]);app.config(["$routeProvider","$httpProvider",function(a,b){b.defaults.useXDomain=!0,delete b.defaults.headers.common["X-Requested-With"],a.when("/",{templateUrl:"templates/home.html",controller:"HomeController"}).when("/users",{templateUrl:"templates/users.html",controller:"UserController"}).when("/pickuser",{templateUrl:"templates/users.html",controller:"UserController"}).when("/statistics",{templateUrl:"templates/statistics.html",controller:"StatisticsController"}).when("/Users/:UserId",{templateUrl:"templates/user.html",controller:"UserIDController"}).when("/table",{templateUrl:"templates/table.html",controller:"TableController"}).when("/editUser/:UserId",{templateUrl:"templates/editUser.html",controller:"UserIDController"}).when("/changePassword/:UserId",{templateUrl:"templates/changePassword.html",controller:"UserIDController"}).when("/addUser",{templateUrl:"templates/addUser.html",controller:"adminController"}).when("/wallOfShame",{templateUrl:"templates/wallOfShame.html",controller:"WallOfShameController"}).otherwise({redirectTo:"/"})}]),$(document).ready(function(){$(".nav a").on("click",function(){$(".nav").find(".active").removeClass("active"),$(this).parent().addClass("active")})}),app.factory("PlayersService",[function(){var a,b,c,d,e,f=!1;return{setPlayer11:function(b){a=b},setPlayer12:function(a){b=a},setPlayer21:function(a){c=a},setPlayer22:function(a){d=a},setCurrent:function(a){e=a},setPlayers:function(e){a=e[0],b=e[1],c=e[2],d=e[3]},getPlayer11:function(){return a},getPlayer12:function(){return b},getPlayer21:function(){return c},getPlayer22:function(){return d},getCurrent:function(){return e},clearPlayers:function(){a=null,b=null,c=null,d=null,e=null},clearCurrent:function(){e=null},rematch:function(){var e=a;a=c,c=e,e=b,b=d,d=e},setGameOn:function(a){f=a},getGameOn:function(){return f}}}]),app.factory("SocketService",["$http",function(){var a;return{setConnected:function(b){a=b},getSocket:function(){return a}}}]),app.controller("adminController",["$scope","$http","$location","SocketService","PlayersService",function(a,b,c){a.newName="",a.newImagePath="",a.newPassword="",a.newPassword2="",a.errorMessageName="",a.errorMessagePassword="",a.addUser=function(d,e,f){var g=["jpeg","jpg","png"],h=document.getElementById("imgPath").value.split(".").pop().toLowerCase(),i=!1;if(""===a.newName)return void(a.errorMessageName="You must enter a valid name");if(a.errorMessageName="",""===a.newPassword)return void(a.errorMessagePassword="Your account must have a password");if(a.errorMessagePassword="",""===a.newPassword2)return void(a.errorMessagePassword="You must confirm your password");if(a.errorMessagePassword="",a.newPassword!==a.newPassword2)return void(a.errorMessagePassword="Your passwords do not match");a.errorMessagePassword="";for(var j in g)if(h===g[j]){i=!0;break}i||(e="");var k={Name:d,ImagePath:e,Password:f},l=JSON.stringify(k),m={method:"POST",url:"http://apprekdbs01.ad.acme.is:8000/Fussball_Project/tempUser.xsjs",headers:{"Content-Type":"application/json;charset=utf-8",dataType:"json",Authorization:"Basic RlVTOlNhbGFzYW5hMTIzNA=="},data:l};console.log(k),b(m).success(function(){console.log("successfully added user"),c.path("/users")}).error(function(b){a.errorMessage=b,console.log(b)})}}]),app.controller("HomeController",["$scope","$location","SocketService","PlayersService",function(a,b,c,d){function e(){if(console.log(h),0!==i&&h){now=new Date,dif=new Date(now.getTime()-i.getTime());var a=dif.getMinutes()<10?"0"+dif.getMinutes():dif.getMinutes(),b=dif.getSeconds()<10?"0"+dif.getSeconds():dif.getSeconds();$(".gameClock").text(a+":"+b)}}a.topList={},a.goalHistory={};var f="10.42.104.61:3000/",g=io.connect(f),h=!1,i=0;setInterval(e,1e3),$.ajax({url:"http://"+f+"players",type:"GET",success:function(b){b.length&&(a.player11=b[0],a.player12=b[1],a.player21=b[2],a.player22=b[3],h=!0,d.setPlayers(b),d.setGameOn(!0),a.$digest()),console.log(b)},error:function(a){console.log(a)}}),$.ajax({url:"http://"+f+"getScore",type:"GET",success:function(a){$("#team1").text(a[0]),$("#team2").text(a[1])}}),g.on("goal1",function(b,c){$("#team1").text(b),console.log(c),c&&(a.goalHistory.unshift(c),a.$digest())}),g.on("goal2",function(b,c){$("#team2").text(b),c&&(a.goalHistory.unshift(c),a.$digest())}),g.on("gameover",function(){h=!1,console.log("gameover")}),g.on("gametime",function(b,c){i=new Date(b),c&&(a.goalHistory=c.reverse(),a.$digest(),console.log(a.goalHistory))}),g.on("updatePlayers",function(b){d.setPlayers(b),a.player11=b[0],a.player12=b[1],a.player21=b[2],a.player22=b[3],a.goalHistory={},a.$digest(),a.player11?h=!0:$(".gameClock").text("00:00"),a.player11&&a.player12&&a.player21&&a.player22&&($("#startGame").hide(),$("#Rematch").hide(),$("#newGame").hide())}),a.clickplayer=function(c){11==c&&a.player11.UserId?b.path("/Users/"+a.player11.UserId):12==c&&a.player12.UserId?b.path("/Users/"+a.player12.UserId):21==c&&a.player21.UserId?b.path("/Users/"+a.player21.UserId):22==c&&a.player22.UserId&&b.path("/Users/"+a.player22.UserId)};var j={"Content-Type":"application/json",dataType:"json",Accept:"application/json",Authorization:"Basic RlVTOlNhbGFzYW5hMTIzNA=="};$.ajax({url:"http://apprekdbs01.ad.acme.is:8000/Fussball_Project/usersELO.xsjs",type:"GET",dataType:"json",headers:j,contentType:"application/json; charset=utf-8",success:function(b){a.topList=b,a.$digest(),console.log(b)},error:function(){console.log("error : ")}})}]),app.controller("StatisticsController",["$scope","$location","SocketService",function(a,b){function c(a){return a>=60&&(min=parseInt(a/60),sek=a%60,a=min+"m "+sek),a}function d(a){return a>=60?(min=parseInt(a/60),sek=a%60,sek=Math.ceil(sek),a=min+"m "+sek):a=Math.ceil(a),a}function e(b){for(var d=[],e=0;e<b.length;e++){var f={user1:"",user2:"",diffsec:0,user1Id:0,user2Id:0,user1Img:"",user2Img:"",date:""},g="";1==b[e].SLOWESTGOALTEAMID?(f.user1=b[e].SLOWESTGOALT1U1NAME,f.user2=b[e].SLOWESTGOALT1U2NAME,g=b[e].SLOWESTGOALDIFF_SEC,f.user1Id=b[e].SLOWESTGOALT1U1ID,f.user2Id=b[e].SLOWESTGOALT1U1ID,f.user1Img=b[e].SLOWESTGOALT1U1IMAGEPATH,f.user2Img=b[e].SLOWESTGOALT1U2IMAGEPATH):(f.user1=b[e].SLOWESTGOALT2U1NAME,f.user2=b[e].SLOWESTGOALT2U2NAME,g=b[e].SLOWESTGOALDIFF_SEC,f.user1Id=b[e].SLOWESTGOALT2U1ID,f.user2Id=b[e].SLOWESTGOALT2U1ID,f.user1Img=b[e].SLOWESTGOALT2U1IMAGEPATH,f.user2Img=b[e].SLOWESTGOALT2U2IMAGEPATH),f.diffsec=c(g),f.date=b[e].SLOWESTGOALTIMEOFGOAL,d.push(f)}a.slowgoalarr=d,a.$digest()}function f(b){for(var d=[],e=0;e<b.length;e++){var f={user1:"",user2:"",user3:"",user4:"",diffsec:0,user1Id:0,user2Id:0,user3Id:0,user4Id:0,user1Img:"",user2Img:"",user3Img:"",user4Img:""},g="";1==b[e].SLOWESTGAMEWINNINGTEAM?(f.user1=b[e].SLOWESTGAMET1U1NAME,f.user2=b[e].SLOWESTGAMET1U2NAME,f.user3=b[e].SLOWESTGAMET2U1NAME,f.user4=b[e].SLOWESTGAMET2U2NAME,f.user1Id=b[e].SLOWESTGAMET1U1,f.user2Id=b[e].SLOWESTGAMET1U2,f.user3Id=b[e].SLOWESTGAMET2U1,f.user4Id=b[e].SLOWESTGAMET2U2,f.user1Img=b[e].SLOWESTGAMET1U1IMAGEPATH,f.user2Img=b[e].SLOWESTGAMET1U2IMAGEPATH,f.user3Img=b[e].SLOWESTGAMET2U1IMAGEPATH,f.user4Img=b[e].SLOWESTGAMET2U2IMAGEPATH):(f.user1=b[e].SLOWESTGAMET2U1NAME,f.user2=b[e].SLOWESTGAMET2U2NAME,f.user3=b[e].SLOWESTGAMET1U1NAME,f.user4=b[e].SLOWESTGAMET1U2NAME,f.user1Id=b[e].SLOWESTGAMET2U1,f.user2Id=b[e].SLOWESTGAMET2U2,f.user3Id=b[e].SLOWESTGAMET1U1,f.user4Id=b[e].SLOWESTGAMET1U2,f.user1Img=b[e].SLOWESTGAMET2U1IMAGEPATH,f.user2Img=b[e].SLOWESTGAMET2U2IMAGEPATH,f.user3Img=b[e].SLOWESTGAMET1U1IMAGEPATH,f.user4Img=b[e].SLOWESTGAMET1U2IMAGEPATH),g=b[e].SLOWESTGAMELENGTH,f.diffsec=c(g),d.push(f)}a.slowgamearr=d,a.$digest()}function g(b){for(var d=[],e=0;e<b.length;e++){var f={user1:"",user2:"",diffsec:0,user1Id:0,user2Id:0,user1Img:"",user2Img:"",date:""},g="";1==b[e].QUICKESTGOALTEAMID?(f.user1=b[e].QUICKESTGOALT1U1NAME,f.user2=b[e].QUICKESTGOALT1U2NAME,f.user1Id=b[e].QUICKESTGOALT1U1ID,f.user2Id=b[e].QUICKESTGOALT1U1ID,f.user1Img=b[e].QUICKESTGOALT1U1IMAGEPATH,f.user2Img=b[e].QUICKESTGOALT1U2IMAGEPATH):(f.user1=b[e].QUICKESTGOALT2U1NAME,f.user2=b[e].QUICKESTGOALT2U2NAME,f.user1Id=b[e].QUICKESTGOALT2U1ID,f.user2Id=b[e].QUICKESTGOALT2U1ID,f.user1Img=b[e].QUICKESTGOALT2U1IMAGEPATH,f.user2Img=b[e].QUICKESTGOALT2U2IMAGEPATH),f.date=b[e].QUICKESTGOALTIMEOFGOAL,g=b[e].QUICKESTGOALDIFF_SEC,f.diffsec=c(g),d.push(f)}a.quickgoalarr=d,a.$digest()}function h(b){for(var d=[],e=0;e<b.length;e++){var f={user1:"",user2:"",user3:"",user4:"",diffsec:0,user1Id:0,user2Id:0,user3Id:0,user4Id:0,user1Img:"",user2Img:"",user3Img:"",user4Img:""},g="";1==b[e].QUICKESTGAMEWINNINGTEAM?(f.user1=b[e].QUICKESTGAMET1U1NAME,f.user2=b[e].QUICKESTGAMET1U2NAME,f.user3=b[e].QUICKESTGAMET2U1NAME,f.user4=b[e].QUICKESTGAMET2U2NAME,f.user1Id=b[e].QUICKESTGAMET1U1,f.user2Id=b[e].QUICKESTGAMET1U2,f.user3Id=b[e].QUICKESTGAMET2U1,f.user4Id=b[e].QUICKESTGAMET2U2,f.user1Img=b[e].QUICKESTGAMET1U1IMAGEPATH,f.user2Img=b[e].QUICKESTGAMET1U2IMAGEPATH,f.user3Img=b[e].QUICKESTGAMET2U1IMAGEPATH,f.user4Img=b[e].QUICKESTGAMET2U2IMAGEPATH):(f.user1=b[e].QUICKESTGAMET2U1NAME,f.user2=b[e].QUICKESTGAMET2U2NAME,f.user3=b[e].QUICKESTGAMET1U1NAME,f.user4=b[e].QUICKESTGAMET1U2NAME,f.user1Id=b[e].QUICKESTGAMET2U1,f.user2Id=b[e].QUICKESTGAMET2U2,f.user3Id=b[e].QUICKESTGAMET1U1,f.user4Id=b[e].QUICKESTGAMET1U2,f.user1Img=b[e].QUICKESTGAMET2U1IMAGEPATH,f.user2Img=b[e].QUICKESTGAMET2U2IMAGEPATH,f.user3Img=b[e].QUICKESTGAMET1U1IMAGEPATH,f.user4Img=b[e].QUICKESTGAMET1U2IMAGEPATH),g=b[e].QUICKESTGAMELENGTH,f.diffsec=c(g),d.push(f)}a.quickgamearr=d,a.$digest()}function i(b){for(var c=[],d=0;d<b.length;d++){var e={user1:"",elo:0,user1Id:0,user1Img:""};e.user1=b[d].TOPELONAME,e.elo=b[d].TOPELOSCORE,e.user1Id=b[d].TOPELOID,e.user1Img=b[d].TOPELOIMAGEPATH,c.push(e)}a.eloarr=c,a.$digest()}function j(b){for(var c=[],d=0;d<b.length;d++){var e={user1:"",user2:"",user3:"",user4:"",deficit:0,user1Id:0,user2Id:0,user3Id:0,user4Id:0,user1Img:"",user2Img:"",user3Img:"",user4Img:""};1==b[d].COMEBACKWINNING_TEAM?(e.user1=b[d].COMEBACKT1U1NAME,e.user2=b[d].COMEBACKT1U2NAME,e.user3=b[d].COMEBACKT2U1NAME,e.user4=b[d].COMEBACKT2U2NAME,e.user1Id=b[d].COMEBACKT1U1ID,e.user2Id=b[d].COMEBACKT1U2ID,e.user3Id=b[d].COMEBACKT2U1ID,e.user4Id=b[d].COMEBACKT2U2ID,e.user1Img=b[d].COMEBACKT1U1IMAGEPATH,e.user2Img=b[d].COMEBACKT1U2IMAGEPATH,e.user3Img=b[d].COMEBACKT2U1IMAGEPATH,e.user4Img=b[d].COMEBACKT2U2IMAGEPATH):(e.user1=b[d].COMEBACKT2U1NAME,e.user2=b[d].COMEBACKT2U2NAME,e.user3=b[d].COMEBACKT1U1NAME,e.user4=b[d].COMEBACKT1U2NAME,e.user1Id=b[d].COMEBACKT2U1,e.user2Id=b[d].COMEBACKT2U2,e.user3Id=b[d].COMEBACKT1U1,e.user4Id=b[d].COMEBACKT1U2,e.user1Img=b[d].COMEBACKT2U1IMAGEPATH,e.user2Img=b[d].COMEBACKT2U2IMAGEPATH,e.user3Img=b[d].COMEBACKT1U1IMAGEPATH,e.user4Img=b[d].COMEBACKT1U2IMAGEPATH),e.deficit=b[d].COMEBACKMAX_DEFICIT,c.push(e)}a.comebackarr=c,a.$digest()}function k(b){for(var c=[],e=0;e<b.length;e++){var f={user1:"",avgtime:0,user1Id:0,user1Img:""};f.user1=b[e].FASTESTPLAYERNAME;var g=b[e].FASTESTPLAYERAVGTIME;f.user1Id=b[e].FASTESTPLAYERID,f.user1Img=b[e].FASTESTPLAYERIMAGEPATH,g=d(g),f.avgtime=g,c.push(f)}a.fastestarr=c,a.$digest()}function l(b){for(var c=[],e=0;e<b.length;e++){var f={user1:"",avgtime:0,user1Id:0,user1Img:""};f.user1=b[e].SLOWESTPLAYERNAME;var g=b[e].SLOWESTPLAYERAVGTIME;f.user1Id=b[e].SLOWESTPLAYERID,f.user1Img=b[e].SLOWESTPLAYERIMAGEPATH,g=d(g),f.avgtime=g,c.push(f)}a.slowestarr=c,a.$digest()}a.moreTop10=[],a.systemStats=[];var m={"Content-Type":"application/json",dataType:"json",Accept:"application/json",Authorization:"Basic RlVTOlNhbGFzYW5hMTIzNA=="};$.ajax({url:"http://apprekdbs01.ad.acme.is:8000/Fussball_Project/systemStats.xsjs",type:"GET",dataType:"json",headers:m,contentType:"application/json; charset=utf-8",success:function(b){b[0].TOTGAMETIME=parseInt(b[0].TOTGAMETIME/60),b[0].TOTGOALS=parseInt(b[0].BLUEGOALS)+parseInt(b[0].BLACKGOALS),a.systemStats=b}}),$.ajax({url:"http://apprekdbs01.ad.acme.is:8000/Fussball_Project/moreTop10.xsjs",type:"GET",dataType:"json",headers:m,contentType:"application/json; charset=utf-8",success:function(b){a.moreTop10=b,a.$digest()}}),$.ajax({url:"http://apprekdbs01.ad.acme.is:8000/Fussball_Project/top10.xsjs",type:"GET",dataType:"json",headers:m,contentType:"application/json; charset=utf-8",success:function(a){e(a),f(a),g(a),h(a),i(a),j(a),k(a),l(a),console.log(a)}}),$(document).ready(function(){$("#lis1").click(function(){$("#l1").show(),$("#l2").hide(),$("#l3").hide(),$("#l4").hide(),$("#l5").hide(),$("#l6").hide(),$("#l7").hide(),$("#l8").hide(),$("#l9").hide(),$("#l10").hide(),$("#l11").hide(),$("#l12").hide(),$("#l13").hide(),$("#l14").hide()}),$("#lis2").click(function(){$("#l1").hide(),$("#l2").show(),$("#l3").hide(),$("#l4").hide(),$("#l5").hide(),$("#l6").hide(),$("#l7").hide(),$("#l8").hide(),$("#l9").hide(),$("#l10").hide(),$("#l11").hide(),$("#l12").hide(),$("#l13").hide(),$("#l14").hide()}),$("#lis3").click(function(){$("#l1").hide(),$("#l2").hide(),$("#l3").show(),$("#l4").hide(),$("#l5").hide(),$("#l6").hide(),$("#l7").hide(),$("#l8").hide(),$("#l9").hide(),$("#l10").hide(),$("#l11").hide(),$("#l12").hide(),$("#l13").hide(),$("#l14").hide()}),$("#lis4").click(function(){$("#l1").hide(),$("#l2").hide(),$("#l3").hide(),$("#l4").show(),$("#l5").hide(),$("#l6").hide(),$("#l7").hide(),$("#l8").hide(),$("#l9").hide(),$("#l10").hide(),$("#l11").hide(),$("#l12").hide(),$("#l13").hide(),$("#l14").hide()}),$("#lis5").click(function(){$("#l1").hide(),$("#l2").hide(),$("#l3").hide(),$("#l4").hide(),$("#l5").show(),$("#l6").hide(),$("#l7").hide(),$("#l8").hide(),$("#l9").hide(),$("#l10").hide(),$("#l11").hide(),$("#l12").hide(),$("#l13").hide(),$("#l14").hide()}),$("#lis6").click(function(){$("#l1").hide(),$("#l2").hide(),$("#l3").hide(),$("#l4").hide(),$("#l5").hide(),$("#l6").show(),$("#l7").hide(),$("#l8").hide(),$("#l9").hide(),$("#l10").hide(),$("#l11").hide(),$("#l12").hide(),$("#l13").hide(),$("#l14").hide()}),$("#lis7").click(function(){$("#l1").hide(),$("#l2").hide(),$("#l3").hide(),$("#l4").hide(),$("#l5").hide(),$("#l6").hide(),$("#l7").show(),$("#l8").hide(),$("#l9").hide(),$("#l10").hide(),$("#l11").hide(),$("#l12").hide(),$("#l13").hide(),$("#l14").hide()}),$("#lis8").click(function(){$("#l1").hide(),$("#l2").hide(),$("#l3").hide(),$("#l4").hide(),$("#l5").hide(),$("#l6").hide(),$("#l7").hide(),$("#l8").show(),$("#l9").hide(),$("#l10").hide(),$("#l11").hide(),$("#l12").hide(),$("#l13").hide(),$("#l14").hide()}),$("#lis9").click(function(){$("#l1").hide(),$("#l2").hide(),$("#l3").hide(),$("#l4").hide(),$("#l5").hide(),$("#l6").hide(),$("#l7").hide(),$("#l8").hide(),$("#l9").show(),$("#l10").hide(),$("#l11").hide(),$("#l12").hide(),$("#l13").hide(),$("#l14").hide()}),$("#lis10").click(function(){$("#l1").hide(),$("#l2").hide(),$("#l3").hide(),$("#l4").hide(),$("#l5").hide(),$("#l6").hide(),$("#l7").hide(),$("#l8").hide(),$("#l9").hide(),$("#l10").show(),$("#l11").hide(),$("#l12").hide(),$("#l13").hide(),$("#l14").hide()}),$("#lis11").click(function(){$("#l1").hide(),$("#l2").hide(),$("#l3").hide(),$("#l4").hide(),$("#l5").hide(),$("#l6").hide(),$("#l7").hide(),$("#l8").hide(),$("#l9").hide(),$("#l10").hide(),$("#l11").show(),$("#l12").hide(),$("#l13").hide(),$("#l14").hide()}),$("#lis12").click(function(){$("#l1").hide(),$("#l2").hide(),$("#l3").hide(),$("#l4").hide(),$("#l5").hide(),$("#l6").hide(),$("#l7").hide(),$("#l8").hide(),$("#l9").hide(),$("#l10").hide(),$("#l11").hide(),$("#l12").show(),$("#l13").hide(),$("#l14").hide()}),$("#lis13").click(function(){$("#l1").hide(),$("#l2").hide(),$("#l3").hide(),$("#l4").hide(),$("#l5").hide(),$("#l6").hide(),$("#l7").hide(),$("#l8").hide(),$("#l9").hide(),$("#l10").hide(),$("#l11").hide(),$("#l12").hide(),$("#l13").show(),$("#l14").hide()}),$("#lis14").click(function(){$("#l1").hide(),$("#l2").hide(),$("#l3").hide(),$("#l4").hide(),$("#l5").hide(),$("#l6").hide(),$("#l7").hide(),$("#l8").hide(),$("#l9").hide(),$("#l10").hide(),$("#l11").hide(),$("#l12").hide(),$("#l13").hide(),$("#l14").show()})}),a.seePlayer=function(a){b.path("/Users/"+a)};var n="highlight",o=$(".thumbnail").click(function(a){a.preventDefault(),o.removeClass(n),$(this).addClass(n)})}]),app.controller("TableController",["$scope","$location","SocketService","PlayersService",function(a,b,c,d){var e="10.42.104.61:3000/",f=io.connect(e);a.gameOn=!1;$.ajax({url:"http://"+e+"players",type:"GET",success:function(b){b.length?(console.log(b[0]),a.player11=b[0],a.player12=b[1],a.player21=b[2],a.player22=b[3],d.setPlayers(b),a.gameOn=!0,$("#modalButtonEndGame").show(),d.setGameOn(!0),a.$digest()):(a.player11={ImagePath:"images/clicktoadd.png"},a.player12={ImagePath:"images/clicktoadd.png"},a.player21={ImagePath:"images/clicktoadd.png"},a.player22={ImagePath:"images/clicktoadd.png"},d.setCurrent(null),d.getPlayer11()&&(a.player11=d.getPlayer11(),d.setCurrent(null)),d.getPlayer12()&&(a.player12=d.getPlayer12(),d.setCurrent(null)),d.getPlayer21()&&(a.player21=d.getPlayer21(),d.setCurrent(null)),d.getPlayer22()&&(a.player22=d.getPlayer22(),d.setCurrent(null)),d.getPlayer11()&&d.getPlayer12()&&d.getPlayer21()&&d.getPlayer22()&&$("#startGame").show(),a.$digest())}}),$.ajax({url:"http://"+e+"getScore",type:"GET",success:function(a){$("#team1").text(a[0]),$("#team2").text(a[1])}}),f.on("goal1",function(a){$("#team1").text(a)}),f.on("goal2",function(a){$("#team2").text(a)}),f.on("gameover",function(){$("#modalButtonEndGame").hide(),$("#Rematch").show(),$("#newGame").show()}),f.on("updatePlayers",function(b){d.setPlayers(b),a.player11=b[0],a.player12=b[1],a.player21=b[2],a.player22=b[3],a.$digest(),a.player11&&a.player12&&a.player21&&a.player22&&($("#startGame").hide(),$("#Rematch").hide(),$("#newGame").hide())}),a.clearCurrent=function(){console.log("worked")},a.clickplayer=function(c){a.gameOn?11==c?b.path("/Users/"+a.player11.UserId):12==c?b.path("/Users/"+a.player12.UserId):21==c?b.path("/Users/"+a.player21.UserId):22==c&&b.path("/Users/"+a.player22.UserId):(d.setCurrent(c),b.path("/pickuser"))},a.gotoStatistics=function(){b.path("/statistics")},a.createGame=function(){$("#startGame").hide();var b={team1user1UserId:d.getPlayer11().UserId,team1user1Name:d.getPlayer11().Name,team1user1ImagePath:d.getPlayer11().ImagePath,ELO0:d.getPlayer11().ELO,team1user2UserId:d.getPlayer12().UserId,team1user2Name:d.getPlayer12().Name,team1user2ImagePath:d.getPlayer12().ImagePath,ELO1:d.getPlayer12().ELO,team2user1UserId:d.getPlayer21().UserId,team2user1Name:d.getPlayer21().Name,team2user1ImagePath:d.getPlayer21().ImagePath,ELO2:d.getPlayer21().ELO,team2user2UserId:d.getPlayer22().UserId,team2user2Name:d.getPlayer22().Name,team2user2ImagePath:d.getPlayer22().ImagePath,ELO3:d.getPlayer22().ELO};$.ajax({url:"http://"+e+"start",type:"POST",data:b,success:function(){a.gameOn=!0,d.setGameOn(!0),$("#modalButtonEndGame").show()}})},a.rematch=function(){d.rematch(),a.player11=d.getPlayer11(),a.player12=d.getPlayer12(),a.player21=d.getPlayer21(),a.player22=d.getPlayer22(),$("#Rematch").hide(),$("#startGame").show(),$("#newGame").show()},a.endGame=function(){console.log("called end game"),$.ajax({url:"http://"+e+"endGame",type:"POST",success:function(b){console.log(b),a.gameOn=!1,d.setGameOn(!1),$("#modalButtonEndGame").hide()}})},a.newGame=function(){a.gameOn=!1,$("#modalButtonEndGame").hide(),d.setGameOn(!1),$("#team1").text(0),$("#team2").text(0),d.clearPlayers(),a.player11=null,a.player12=null,a.player21=null,a.player22=null}}]),app.controller("UserController",["$scope","$location","SocketService","PlayersService",function(a,b,c,d){function e(c){for(var e=!1,f=[],g=0;g<c.length;g++)d.getPlayer11()&&"/users"!=b.$$path&&d.getPlayer11().UserId==c[g].UserId&&(e=!0),d.getPlayer12()&&"/users"!=b.$$path&&d.getPlayer12().UserId==c[g].UserId&&(e=!0),d.getPlayer21()&&"/users"!=b.$$path&&d.getPlayer21().UserId==c[g].UserId&&(e=!0),d.getPlayer22()&&"/users"!=b.$$path&&d.getPlayer22().UserId==c[g].UserId&&(e=!0),e||f.push(c[g]),e=!1;a.arr=f,a.$digest()}var f={"Content-Type":"application/json",dataType:"json",Accept:"application/json",Authorization:"Basic RlVTOlNhbGFzYW5hMTIzNA=="};$.ajax({url:"http://apprekdbs01.ad.acme.is:8000/Fussball_Project/tempUser.xsjs",type:"GET",dataType:"json",headers:f,contentType:"application/json; charset=utf-8",success:function(a){e(a),console.log(a)}}),a.thisPlayer=function(a){d.getCurrent()?(11==d.getCurrent()?d.setPlayer11(a):12==d.getCurrent()?d.setPlayer12(a):21==d.getCurrent()?d.setPlayer21(a):22==d.getCurrent()&&d.setPlayer22(a),b.path("/table")):b.path("/Users/"+a.UserId)},a.randomPlayers=function(){for(var c=[];c.length<4;){for(var e=Math.ceil(Math.random()*a.arr.length-1),f=!1,g=0;g<c.length;g++)if(c[g]==e){f=!0;break}f||(c[c.length]=e)}d.setPlayer11(a.arr[c[0]]),d.setPlayer12(a.arr[c[1]]),d.setPlayer21(a.arr[c[2]]),d.setPlayer22(a.arr[c[3]]),b.path("/table")}}]),app.controller("UserIDController",["$scope","$http","$location","$routeParams","SocketService","PlayersService",function(a,b,c,d){a.user={},a.winp=0,a.newName="",a.newImagePath="",a.password="",a.newPassword="",a.newPassword2="",a.errorMessagePassword="",a.errorMessageName="",a.noGamesPlayedError="",a.gameHistory=[];var e={"Content-Type":"application/json;charset=utf-8",dataType:"json",Accept:"application/json; charset=utf-8",Authorization:"Basic RlVTOlNhbGFzYW5hMTIzNA=="};$.ajax({url:"http://apprekdbs01.ad.acme.is:8000/Fussball_Project/userStatistics.xsjs",type:"GET",dataType:"json",headers:e,contentType:"application/json; charset=utf-8",data:{id:d.UserId},success:function(b){b.length<=0?$.ajax({url:"http://apprekdbs01.ad.acme.is:8000/Fussball_Project/userById.xsjs",type:"GET",dataType:"json",headers:e,contentType:"application/json; charset=utf-8",data:{id:d.UserId},success:function(b){a.user=b,a.user[0].NOGAMES=0,a.noGamesPlayedError="You have to play at least 1 game to get a ranking",a.newName=a.user[0].NAME,a.newImagePath=a.user[0].IMAGEPATH,a.$digest()},error:function(a){console.log("error: "+a)}}):(a.user=b,a.winp=(a.user[0].TOTWINS/a.user[0].NOGAMES*100).toFixed(2),a.newName=a.user[0].NAME,a.newImagePath=a.user[0].IMAGEPATH,a.newPassword="",a.$digest(),$(".noGamesPlayed").show(),historyArr=[],$.ajax({url:"http://apprekdbs01.ad.acme.is:8000/Fussball_Project/gameHistory.xsjs",type:"GET",dataType:"json",headers:e,contentType:"application/json; charset=utf-8",data:{id:d.UserId},success:function(b){for(var c=0;c<b.length;c++)historyObj={t1u1id:0,t1u1name:"",t1u1image:"",t1u2id:0,t1u2name:"",t1u2image:"",t2u1id:0,t2u1name:"",t2u1image:"",t2u2id:0,t2u2name:"",t2u2image:"",scoreteam1:0,scoreteam2:0,starttime:""},b[c].WINNER1==b[c].TEAM1USER1ID?(historyObj.t1u1id=b[c].WINNER1,historyObj.t1u1name=b[c].WINNER1NAME,historyObj.t1u1image=b[c].WINNER1IMAGEPATH,historyObj.t1u2id=b[c].WINNER2,historyObj.t1u2name=b[c].WINNER2NAME,historyObj.t1u2image=b[c].WINNER2IMAGEPATH,historyObj.t2u1id=b[c].LOSER1,historyObj.t2u1name=b[c].LOSER1NAME,historyObj.t2u1image=b[c].LOSER1IMAGEPATH,historyObj.t2u2id=b[c].LOSER2,historyObj.t2u2name=b[c].LOSER2NAME,historyObj.t2u2image=b[c].LOSER2IMAGEPATH):(historyObj.t1u1id=b[c].LOSER1,historyObj.t1u1name=b[c].LOSER1NAME,historyObj.t1u1image=b[c].LOSER1IMAGEPATH,historyObj.t1u2id=b[c].LOSER2,historyObj.t1u2name=b[c].LOSER2NAME,historyObj.t1u2image=b[c].LOSER2IMAGEPATH,historyObj.t2u1id=b[c].WINNER1,historyObj.t2u1name=b[c].WINNER1NAME,historyObj.t2u1image=b[c].WINNER1IMAGEPATH,historyObj.t2u2id=b[c].WINNER2,historyObj.t2u2name=b[c].WINNER2NAME,historyObj.t2u2image=b[c].WINNER2IMAGEPATH),historyObj.scoreteam1=b[c].SCORETEAM1,historyObj.scoreteam2=b[c].SCORETEAM2,historyObj.starttime=b[c].STARTTIME.split(" ")[0],historyArr.push(historyObj);console.log(historyArr),a.gameHistory=historyArr,a.$digest()}}))},error:function(a){return console.log("error : "),a}}),a.goToPlayer=function(a){c.path("/Users/"+a)},a.editUser=function(){c.path("/editUser/"+a.user[0].USERID)},a.changePassword=function(){c.path("changePassword/"+a.user[0].USERID)},a.saveNewPassword=function(d,f){if(a.newPassword!==a.newPassword2)return void(a.errorMessagePassword="New password fields do not match");var g={UserId:a.user[0].USERID,Password:d,NewPassword:f},h=JSON.stringify(g),i={method:"POST",url:"http://apprekdbs01.ad.acme.is:8000/Fussball_Project/changePassword.xsjs",contentType:"application/json; charset=utf-8",headers:e,data:h};console.log(g),b(i).success(function(){console.log("successfully changed password"),c.path("/users")}).error(function(){a.errorMessagePassword="Wrong password"})},a.saveChanges=function(d,f,g){var h=["jpeg","jpg","png"],i=document.getElementById("imgPath").value.split(".").pop().toLowerCase(),j=!1;if(""===a.newName)return void(a.errorMessageName="You must have a valid name");if(a.errorMessageName="",""===a.password)return void(a.errorMessagePassword="Please enter your password");a.errorMessagePassword="";for(var k in h)if(i===h[k]){j=!0;break}j||(f=""),""===a.newName&&(d=a.user[0].NAME);var l={UserId:a.user[0].USERID,Name:d,ImagePath:f,Password:g},m=JSON.stringify(l),n={method:"POST",url:"http://apprekdbs01.ad.acme.is:8000/Fussball_Project/updateUser.xsjs",headers:e,data:m};console.log(l),b(n).success(function(){console.log("successfully updated user"),c.path("/users")}).error(function(){a.errorMessagePassword="Wrong password"})}}]),app.controller("WallOfShameController",["$scope","$location","SocketService",function(a,b){function c(b){for(var c=0;c<b.length;c++){var d=b[c].LOSER1NAME.split(" "),e=b[c].LOSER2NAME.split(" "),f=b[c].WINNER1NAME.split(" "),g=b[c].WINNER2NAME.split(" ");b[c].STARTTIME=b[c].STARTTIME.split(" ")[0],b[c].LOSER1NAME=d.length>2?d[0]+" "+d[1]:d[0],b[c].LOSER2NAME=e.length>2?e[0]+" "+e[1]:e[0],b[c].WINNER1NAME=f.length>2?f[0]+" "+f[1]:f[0],b[c].WINNER2NAME=g.length>2?g[0]+" "+g[1]:g[0]}a.ShameGame=b,a.$digest(),console.log(b)}a.ShameGame=[];var d={"Content-Type":"application/json",dataType:"json",Accept:"application/json",Authorization:"Basic RlVTOlNhbGFzYW5hMTIzNA=="};$.ajax({url:"http://apprekdbs01.ad.acme.is:8000/Fussball_Project/wallOfShame.xsjs",type:"GET",dataType:"json",headers:d,contentType:"application/json; charset=utf-8",success:function(a){c(a)}}),a.seePlayer=function(a){b.path("/Users/"+a)}}]);