var app=angular.module("Fusball",["ngRoute"]);app.config(["$routeProvider","$httpProvider",function(a,b){b.defaults.useXDomain=!0,delete b.defaults.headers.common["X-Requested-With"],a.when("/",{templateUrl:"templates/home.html",controller:"HomeController"}).when("/users",{templateUrl:"templates/users.html",controller:"UserController"}).when("/statistics",{templateUrl:"templates/statistics.html",controller:"StatisticsController"}).otherwise({redirectTo:"/"})}]),app.factory("PlayersService",[function(){var a,b,c,d,e;return{setPlayer11:function(b){a=b},setPlayer12:function(a){b=a},setPlayer21:function(a){c=a},setPlayer22:function(a){d=a},setCurrent:function(a){e=a},getPlayer11:function(){return a},getPlayer12:function(){return b},getPlayer21:function(){return c},getPlayer22:function(){return d},getCurrent:function(){return e}}}]),app.factory("SocketService",["$http",function(){var a;return{setConnected:function(b){a=b},getSocket:function(){return a}}}]),app.controller("HomeController",["$scope","$location","SocketService","PlayersService",function(a,b,c,d){var e=io.connect("10.42.104.61:3000/");e.emit("getScore"),a.player11="Player 1",a.player12="Player 2",a.player21="Player 1",a.player22="Player 2",d.setCurrent(null),d.getPlayer11()&&(a.player11=d.getPlayer11().Name,d.setCurrent(null)),d.getPlayer12()&&(a.player12=d.getPlayer12().Name,d.setCurrent(null)),d.getPlayer21()&&(a.player21=d.getPlayer21().Name,d.setCurrent(null)),d.getPlayer22()&&(a.player22=d.getPlayer22().Name,d.setCurrent(null)),d.getPlayer11()&&d.getPlayer12()&&d.getPlayer21()&&d.getPlayer22()&&$("#startGame").show(),e.on("goal1",function(a){$("#team1").text(a)}),e.on("goal2",function(a){$("#team2").text(a)}),a.clickplayer=function(a){d.setCurrent(a),b.path("/users")},a.gotoStatistics=function(){b.path("/statistics")},a.createGame=function(){$("#startGame").hide();var a={team1user1:d.getPlayer11(),team1user2:d.getPlayer12(),team2user1:d.getPlayer21(),team2user2:d.getPlayer22()};$.ajax({url:"http://10.42.104.61:3000/start",type:"POST",data:a,success:function(a){console.log(a)}})}}]),app.controller("StatisticsController",["$scope","$location","SocketService",function(){}]),app.controller("UserController",["$scope","$location","SocketService","PlayersService",function(a,b,c,d){function e(b){for(var c=!1,e=[],f=0;f<b.length;f++)d.getPlayer11()&&d.getPlayer11().UserId==b[f].UserId&&(c=!0),d.getPlayer12()&&d.getPlayer12().UserId==b[f].UserId&&(c=!0),d.getPlayer21()&&d.getPlayer21().UserId==b[f].UserId&&(c=!0),d.getPlayer22()&&d.getPlayer22().UserId==b[f].UserId&&(c=!0),c||e.push(b[f]),c=!1;a.arr=e,a.$digest()}var f={"Content-Type":"application/json",dataType:"json",Accept:"application/json",Authorization:"Basic RlVTOlNhbGFzYW5hMTIzNA=="};$.ajax({url:"http://apprekdbs01.ad.acme.is:8000/Fussball_Project/tempUser.xsjs",type:"GET",dataType:"json",headers:f,contentType:"application/json; charset=utf-8",success:function(a){e(a),console.log(a)}}),a.randomPlayers=function(){for(var c=[];c.length<4;){for(var e=Math.ceil(Math.random()*a.arr.length-1),f=!1,g=0;g<c.length;g++)if(c[g]==e){f=!0;break}f||(c[c.length]=e)}d.setPlayer11(a.arr[c[0]]),d.setPlayer12(a.arr[c[1]]),d.setPlayer21(a.arr[c[2]]),d.setPlayer22(a.arr[c[3]]),b.path("/")},a.thisPlayer=function(a){11==d.getCurrent()?d.setPlayer11(a):12==d.getCurrent()?d.setPlayer12(a):21==d.getCurrent()?d.setPlayer21(a):22==d.getCurrent()&&d.setPlayer22(a),b.path("/")}}]);